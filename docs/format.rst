File formats
=============================

Input
-------------------------

HiC map
............

a bin-contact pair format
^^^^^^^^^^^

-in\_bin
''''''''

A bin file defines the chromosome, start and end positions of each bin.

::

 cbin   chr from.coord  to.coord
  1     2L  6000        7000
  2     2L  7000        8000     
  3     2L  8000        9000     
  4     2L  9000        10000     
  5     2L  12000       13000


-in\_map 
''''''''

A contact map contains Hi-C intensity indexed by bins (text format).

::

 cbin1   cbin2   expected_count  observed_count     
  1   1   0.077080    50     
  1   2   0.389912    314     
  1   3   0.493750    163     
  1   4   0.560505    169     
  1   5   0.368884    79

- expected\_count : the expected contact between those two genome locis (bins) according to model. It could be 1 if no model is applied.
- observed\_count : the observed contact between those two genome locis (bins) in Hi-C data

It takes time to parse text format so we develop ``bin/genBiMap`` to turn text format (.n_contact) into binary format (.bimap) which could be used in -in\_map.

::
 
 genBiMap [options] -in_ncontact input.n_contact -out_bimap out.bimap
 >bin/genBiMap -in_ncontact example/fly.n_contact -out_bimap example/fly.bimap
 >hicmaptools -in_map example/fly.bimap -in_bin 30000.cbins -bat BAT.bed -output test.tsv 

.hic format
^^^^^^^^^^^
The . *hic* format is generated by `Juicer <https://github.com/aidenlab/juicer>`_. The parser of . *hic* format is adapted from `straw <https://github.com/aidenlab/straw>`_.

Query file
............

The query file is in `bed format <https://genome.ucsc.edu/FAQ/FAQformat.html#format1>`_ where the first three columns are enough.
The example file of each query mode is listed:

- bat: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_
- local: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_
- loop: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_
- pair: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_
- sites: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_
- submap: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_
- TAD: `bat.bed <https://github.com/changlabtw/hicmaptools/blob/master/examples/bat.bed>`_

Output
-------------------------

There are two output files. You can use the tool ``tools/visualizeRandomTest.R`` to examine query's contact intensity aganist the null hypothesis (`Shuffle test <random.html>`_).

- output.tsv : the contact intensity of you interested

::

    index   chrom   start   end ... rank_obs    rank_exp    rank_nor    
    1   3R  100000  200000  ...     0.880       0.990       0.760

- output **_random** .tsv : the contact intensities of the null hypothesis
